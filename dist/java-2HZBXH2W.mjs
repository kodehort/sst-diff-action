import{e as ce,f as ue,g as ae,h as le,v as Ee,w as de,x as me,y as Ie}from"./chunk-PT6L7NJD.mjs";import"./chunk-7H2TFXPN.mjs";import"./chunk-IQOVF5LO.mjs";import{a as fe}from"./chunk-5PARVRO5.mjs";import"./chunk-3PEVV4HI.mjs";import"./chunk-R6PYGTER.mjs";import"./chunk-SUBS3TDM.mjs";import"./chunk-KU6QELUJ.mjs";import"./chunk-ISPMX3VH.mjs";import"./chunk-THC7OU5T.mjs";import{a as H,c as F,e as Xe}from"./chunk-7S7IXY6P.mjs";var Y=F(he=>{he.require=function(){if(typeof process=="object"&&process.versions&&process.versions.electron)try{let e=H("original-fs");if(Object.keys(e).length>0)return e}catch{}return H("fs")}});var $=F((mt,ge)=>{ge.exports={LOCHDR:30,LOCSIG:67324752,LOCVER:4,LOCFLG:6,LOCHOW:8,LOCTIM:10,LOCCRC:14,LOCSIZ:18,LOCLEN:22,LOCNAM:26,LOCEXT:28,EXTSIG:134695760,EXTHDR:16,EXTCRC:4,EXTSIZ:8,EXTLEN:12,CENHDR:46,CENSIG:33639248,CENVEM:4,CENVER:6,CENFLG:8,CENHOW:10,CENTIM:12,CENCRC:16,CENSIZ:20,CENLEN:24,CENNAM:28,CENEXT:30,CENCOM:32,CENDSK:34,CENATT:36,CENATX:38,CENOFF:42,ENDHDR:22,ENDSIG:101010256,ENDSUB:8,ENDTOT:10,ENDSIZ:12,ENDOFF:16,ENDCOM:20,END64HDR:20,END64SIG:117853008,END64START:4,END64OFF:8,END64NUMDISKS:16,ZIP64SIG:101075792,ZIP64HDR:56,ZIP64LEAD:12,ZIP64SIZE:4,ZIP64VEM:12,ZIP64VER:14,ZIP64DSK:16,ZIP64DSKDIR:20,ZIP64SUB:24,ZIP64TOT:32,ZIP64SIZB:40,ZIP64OFF:48,ZIP64EXTRA:56,STORED:0,SHRUNK:1,REDUCED1:2,REDUCED2:3,REDUCED3:4,REDUCED4:5,IMPLODED:6,DEFLATED:8,ENHANCED_DEFLATED:9,PKWARE:10,BZIP2:12,LZMA:14,IBM_TERSE:18,IBM_LZ77:19,AES_ENCRYPT:99,FLG_ENC:1,FLG_COMP1:2,FLG_COMP2:4,FLG_DESC:8,FLG_ENH:16,FLG_PATCH:32,FLG_STR:64,FLG_EFS:2048,FLG_MSK:4096,FILE:2,BUFFER:1,NONE:0,EF_ID:0,EF_SIZE:2,ID_ZIP64:1,ID_AVINFO:7,ID_PFS:8,ID_OS2:9,ID_NTFS:10,ID_OPENVMS:12,ID_UNIX:13,ID_FORK:14,ID_PATCH:15,ID_X509_PKCS7:20,ID_X509_CERTID_F:21,ID_X509_CERTID_C:22,ID_STRONGENC:23,ID_RECORD_MGT:24,ID_X509_PKCS7_RL:25,ID_IBM1:101,ID_IBM2:102,ID_POSZIP:18064,EF_ZIP64_OR_32:4294967295,EF_ZIP64_OR_16:65535,EF_ZIP64_SUNCOMP:0,EF_ZIP64_SCOMP:8,EF_ZIP64_RHO:16,EF_ZIP64_DSN:24}});var k=F((It,De)=>{De.exports={INVALID_LOC:"Invalid LOC header (bad signature)",INVALID_CEN:"Invalid CEN header (bad signature)",INVALID_END:"Invalid END header (bad signature)",NO_DATA:"Nothing to decompress",BAD_CRC:"CRC32 checksum failed",FILE_IN_THE_WAY:"There is a file in the way: %s",UNKNOWN_METHOD:"Invalid/unsupported compression method",AVAIL_DATA:"inflate::Available inflate data did not terminate",INVALID_DISTANCE:"inflate::Invalid literal/length or distance code in fixed or dynamic block",TO_MANY_CODES:"inflate::Dynamic block code description: too many length or distance codes",INVALID_REPEAT_LEN:"inflate::Dynamic block code description: repeat more than specified lengths",INVALID_REPEAT_FIRST:"inflate::Dynamic block code description: repeat lengths with no first length",INCOMPLETE_CODES:"inflate::Dynamic block code description: code lengths codes incomplete",INVALID_DYN_DISTANCE:"inflate::Dynamic block code description: invalid distance code lengths",INVALID_CODES_LEN:"inflate::Dynamic block code description: invalid literal/length code lengths",INVALID_STORE_BLOCK:"inflate::Stored block length did not match one's complement",INVALID_BLOCK_TYPE:"inflate::Invalid block type (type == 3)",CANT_EXTRACT_FILE:"Could not extract the file",CANT_OVERRIDE:"Target file already exists",NO_ZIP:"No zip file was loaded",NO_ENTRY:"Entry doesn't exist",DIRECTORY_CONTENT_ERROR:"A directory cannot have content",FILE_NOT_FOUND:"File not found: %s",NOT_IMPLEMENTED:"Not implemented",INVALID_FILENAME:"Invalid filename",INVALID_FORMAT:"Invalid or unsupported zip format. No END header found"}});var Ce=F((ht,Le)=>{var Ke=Y().require(),U=H("path"),ye=$(),Je=k(),Ye=typeof process=="object"&&process.platform==="win32",Ne=e=>e&&typeof e=="object",Q=new Uint32Array(256).map((e,n)=>{for(let s=0;s<8;s++)n&1?n=3988292384^n>>>1:n>>>=1;return n>>>0});function x(e){this.sep=U.sep,this.fs=Ke,Ne(e)&&Ne(e.fs)&&typeof e.fs.statSync=="function"&&(this.fs=e.fs)}Le.exports=x;x.prototype.makeDir=function(e){let n=this;function s(a){let f=a.split(n.sep)[0];a.split(n.sep).forEach(function(o){if(!(!o||o.substr(-1,1)===":")){f+=n.sep+o;var d;try{d=n.fs.statSync(f)}catch{n.fs.mkdirSync(f)}if(d&&d.isFile())throw Je.FILE_IN_THE_WAY.replace("%s",f)}})}s(e)};x.prototype.writeFileTo=function(e,n,s,a){let f=this;if(f.fs.existsSync(e)){if(!s)return!1;var o=f.fs.statSync(e);if(o.isDirectory())return!1}var d=U.dirname(e);f.fs.existsSync(d)||f.makeDir(d);var y;try{y=f.fs.openSync(e,"w",438)}catch{f.fs.chmodSync(e,438),y=f.fs.openSync(e,"w",438)}if(y)try{f.fs.writeSync(y,n,0,n.length,0)}finally{f.fs.closeSync(y)}return f.fs.chmodSync(e,a||438),!0};x.prototype.writeFileToAsync=function(e,n,s,a,f){typeof a=="function"&&(f=a,a=void 0);let o=this;o.fs.exists(e,function(d){if(d&&!s)return f(!1);o.fs.stat(e,function(y,g){if(d&&g.isDirectory())return f(!1);var L=U.dirname(e);o.fs.exists(L,function(c){c||o.makeDir(L),o.fs.open(e,"w",438,function(E,m){E?o.fs.chmod(e,438,function(){o.fs.open(e,"w",438,function(u,t){o.fs.write(t,n,0,n.length,0,function(){o.fs.close(t,function(){o.fs.chmod(e,a||438,function(){f(!0)})})})})}):m?o.fs.write(m,n,0,n.length,0,function(){o.fs.close(m,function(){o.fs.chmod(e,a||438,function(){f(!0)})})}):o.fs.chmod(e,a||438,function(){f(!0)})})})})})};x.prototype.findFiles=function(e){let n=this;function s(a,f,o){typeof f=="boolean"&&(o=f,f=void 0);let d=[];return n.fs.readdirSync(a).forEach(function(y){var g=U.join(a,y);n.fs.statSync(g).isDirectory()&&o&&(d=d.concat(s(g,f,o))),(!f||f.test(g))&&d.push(U.normalize(g)+(n.fs.statSync(g).isDirectory()?n.sep:""))}),d}return s(e,void 0,!0)};x.prototype.getAttributes=function(){};x.prototype.setAttributes=function(){};x.crc32update=function(e,n){return Q[(e^n)&255]^e>>>8};x.crc32=function(e){typeof e=="string"&&(e=Buffer.from(e,"utf8")),Q.length||genCRCTable();let n=e.length,s=-1;for(let a=0;a<n;)s=x.crc32update(s,e[a++]);return~s>>>0};x.methodToString=function(e){switch(e){case ye.STORED:return"STORED ("+e+")";case ye.DEFLATED:return"DEFLATED ("+e+")";default:return"UNSUPPORTED ("+e+")"}};x.canonical=function(e){if(!e)return"";var n=U.posix.normalize("/"+e.split("\\").join("/"));return U.join(".",n)};x.sanitize=function(e,n){e=U.resolve(U.normalize(e));for(var s=n.split("/"),a=0,f=s.length;a<f;a++){var o=U.normalize(U.join(e,s.slice(a,f).join(U.sep)));if(o.indexOf(e)===0)return o}return U.normalize(U.join(e,U.basename(n)))};x.toBuffer=function(n){return Buffer.isBuffer(n)?n:n instanceof Uint8Array?Buffer.from(n):typeof n=="string"?Buffer.from(n,"utf8"):Buffer.alloc(0)};x.readBigUInt64LE=function(e,n){var s=Buffer.from(e.slice(n,n+8));return s.swap64(),parseInt(`0x${s.toString("hex")}`)};x.isWin=Ye;x.crcTable=Q});var _e=F((gt,Se)=>{var q=Y().require(),pe=H("path");q.existsSync=q.existsSync||pe.existsSync;Se.exports=function(e){var n=e||"",s=f(),a=null;function f(){return{directory:!1,readonly:!1,hidden:!1,executable:!1,mtime:0,atime:0}}return n&&q.existsSync(n)?(a=q.statSync(n),s.directory=a.isDirectory(),s.mtime=a.mtime,s.atime=a.atime,s.executable=(73&a.mode)!==0,s.readonly=(128&a.mode)===0,s.hidden=pe.basename(n)[0]==="."):console.warn("Invalid path: "+n),{get directory(){return s.directory},get readOnly(){return s.readonly},get hidden(){return s.hidden},get mtime(){return s.mtime},get atime(){return s.atime},get executable(){return s.executable},decodeAttributes:function(){},encodeAttributes:function(){},toJSON:function(){return{path:n,isDirectory:s.directory,isReadOnly:s.readonly,isHidden:s.hidden,isExecutable:s.executable,mTime:s.mtime,aTime:s.atime}},toString:function(){return JSON.stringify(this.toJSON(),null,"	")}}}});var z=F((Dt,j)=>{j.exports=Ce();j.exports.Constants=$();j.exports.Errors=k();j.exports.FileAttr=_e()});var we=F((yt,Oe)=>{var G=z(),h=G.Constants;Oe.exports=function(){var e=20,n=10,s=0,a=0,f=0,o=0,d=0,y=0,g=0,L=0,c=0,E=0,m=0,u=0,t=0;e|=G.isWin?2560:768,s|=h.FLG_EFS;var i={};function l(r){r=new Date(r),f=(r.getFullYear()-1980&127)<<25|r.getMonth()+1<<21|r.getDate()<<16|r.getHours()<<11|r.getMinutes()<<5|r.getSeconds()>>1}return l(+new Date),{get made(){return e},set made(r){e=r},get version(){return n},set version(r){n=r},get flags(){return s},set flags(r){s=r},get method(){return a},set method(r){switch(r){case h.STORED:this.version=10;case h.DEFLATED:default:this.version=20}a=r},get time(){return new Date((f>>25&127)+1980,(f>>21&15)-1,f>>16&31,f>>11&31,f>>5&63,(f&31)<<1)},set time(r){l(r)},get crc(){return o},set crc(r){o=Math.max(0,r)>>>0},get compressedSize(){return d},set compressedSize(r){d=Math.max(0,r)>>>0},get size(){return y},set size(r){y=Math.max(0,r)>>>0},get fileNameLength(){return g},set fileNameLength(r){g=r},get extraLength(){return L},set extraLength(r){L=r},get commentLength(){return c},set commentLength(r){c=r},get diskNumStart(){return E},set diskNumStart(r){E=Math.max(0,r)>>>0},get inAttr(){return m},set inAttr(r){m=Math.max(0,r)>>>0},get attr(){return u},set attr(r){u=Math.max(0,r)>>>0},get fileAttr(){return u?(u>>>0|0)>>16&4095:0},get offset(){return t},set offset(r){t=Math.max(0,r)>>>0},get encripted(){return(s&1)===1},get entryHeaderSize(){return h.CENHDR+g+L+c},get realDataOffset(){return t+h.LOCHDR+i.fnameLen+i.extraLen},get dataHeader(){return i},loadDataHeaderFromBinary:function(r){var I=r.slice(t,t+h.LOCHDR);if(I.readUInt32LE(0)!==h.LOCSIG)throw new Error(G.Errors.INVALID_LOC);i={version:I.readUInt16LE(h.LOCVER),flags:I.readUInt16LE(h.LOCFLG),method:I.readUInt16LE(h.LOCHOW),time:I.readUInt32LE(h.LOCTIM),crc:I.readUInt32LE(h.LOCCRC),compressedSize:I.readUInt32LE(h.LOCSIZ),size:I.readUInt32LE(h.LOCLEN),fnameLen:I.readUInt16LE(h.LOCNAM),extraLen:I.readUInt16LE(h.LOCEXT)}},loadFromBinary:function(r){if(r.length!==h.CENHDR||r.readUInt32LE(0)!==h.CENSIG)throw new Error(G.Errors.INVALID_CEN);e=r.readUInt16LE(h.CENVEM),n=r.readUInt16LE(h.CENVER),s=r.readUInt16LE(h.CENFLG),a=r.readUInt16LE(h.CENHOW),f=r.readUInt32LE(h.CENTIM),o=r.readUInt32LE(h.CENCRC),d=r.readUInt32LE(h.CENSIZ),y=r.readUInt32LE(h.CENLEN),g=r.readUInt16LE(h.CENNAM),L=r.readUInt16LE(h.CENEXT),c=r.readUInt16LE(h.CENCOM),E=r.readUInt16LE(h.CENDSK),m=r.readUInt16LE(h.CENATT),u=r.readUInt32LE(h.CENATX),t=r.readUInt32LE(h.CENOFF)},dataHeaderToBinary:function(){var r=Buffer.alloc(h.LOCHDR);return r.writeUInt32LE(h.LOCSIG,0),r.writeUInt16LE(n,h.LOCVER),r.writeUInt16LE(s,h.LOCFLG),r.writeUInt16LE(a,h.LOCHOW),r.writeUInt32LE(f,h.LOCTIM),r.writeUInt32LE(o,h.LOCCRC),r.writeUInt32LE(d,h.LOCSIZ),r.writeUInt32LE(y,h.LOCLEN),r.writeUInt16LE(g,h.LOCNAM),r.writeUInt16LE(L,h.LOCEXT),r},entryHeaderToBinary:function(){var r=Buffer.alloc(h.CENHDR+g+L+c);return r.writeUInt32LE(h.CENSIG,0),r.writeUInt16LE(e,h.CENVEM),r.writeUInt16LE(n,h.CENVER),r.writeUInt16LE(s,h.CENFLG),r.writeUInt16LE(a,h.CENHOW),r.writeUInt32LE(f,h.CENTIM),r.writeUInt32LE(o,h.CENCRC),r.writeUInt32LE(d,h.CENSIZ),r.writeUInt32LE(y,h.CENLEN),r.writeUInt16LE(g,h.CENNAM),r.writeUInt16LE(L,h.CENEXT),r.writeUInt16LE(c,h.CENCOM),r.writeUInt16LE(E,h.CENDSK),r.writeUInt16LE(m,h.CENATT),r.writeUInt32LE(u,h.CENATX),r.writeUInt32LE(t,h.CENOFF),r.fill(0,h.CENHDR),r},toJSON:function(){let r=function(I){return I+" bytes"};return{made:e,version:n,flags:s,method:G.methodToString(a),time:this.time,crc:"0x"+o.toString(16).toUpperCase(),compressedSize:r(d),size:r(y),fileNameLength:r(g),extraLength:r(L),commentLength:r(c),diskNumStart:E,inAttr:m,attr:u,offset:t,entryHeaderSize:r(h.CENHDR+g+L+c)}},toString:function(){return JSON.stringify(this.toJSON(),null,"	")}}}});var xe=F((Nt,Te)=>{var P=z(),p=P.Constants;Te.exports=function(){var e=0,n=0,s=0,a=0,f=0;return{get diskEntries(){return e},set diskEntries(o){e=n=o},get totalEntries(){return n},set totalEntries(o){n=e=o},get size(){return s},set size(o){s=o},get offset(){return a},set offset(o){a=o},get commentLength(){return f},set commentLength(o){f=o},get mainHeaderSize(){return p.ENDHDR+f},loadFromBinary:function(o){if((o.length!==p.ENDHDR||o.readUInt32LE(0)!==p.ENDSIG)&&(o.length<p.ZIP64HDR||o.readUInt32LE(0)!==p.ZIP64SIG))throw new Error(P.Errors.INVALID_END);o.readUInt32LE(0)===p.ENDSIG?(e=o.readUInt16LE(p.ENDSUB),n=o.readUInt16LE(p.ENDTOT),s=o.readUInt32LE(p.ENDSIZ),a=o.readUInt32LE(p.ENDOFF),f=o.readUInt16LE(p.ENDCOM)):(e=P.readBigUInt64LE(o,p.ZIP64SUB),n=P.readBigUInt64LE(o,p.ZIP64TOT),s=P.readBigUInt64LE(o,p.ZIP64SIZE),a=P.readBigUInt64LE(o,p.ZIP64OFF),f=0)},toBinary:function(){var o=Buffer.alloc(p.ENDHDR+f);return o.writeUInt32LE(p.ENDSIG,0),o.writeUInt32LE(0,4),o.writeUInt16LE(e,p.ENDSUB),o.writeUInt16LE(n,p.ENDTOT),o.writeUInt32LE(s,p.ENDSIZ),o.writeUInt32LE(a,p.ENDOFF),o.writeUInt16LE(f,p.ENDCOM),o.fill(" ",p.ENDHDR),o},toJSON:function(){let o=function(d,y){let g=d.toString(16).toUpperCase();for(;g.length<y;)g="0"+g;return"0x"+g};return{diskEntries:e,totalEntries:n,size:s+" bytes",offset:o(a,4),commentLength:f}},toString:function(){return JSON.stringify(this.toJSON(),null,"	")}}}});var te=F(ee=>{ee.EntryHeader=we();ee.MainHeader=xe()});var Fe=F((Ct,Ae)=>{Ae.exports=function(e){var n=H("zlib"),s={chunkSize:(parseInt(e.length/1024)+1)*1024};return{deflate:function(){return n.deflateRawSync(e,s)},deflateAsync:function(a){var f=n.createDeflateRaw(s),o=[],d=0;f.on("data",function(y){o.push(y),d+=y.length}),f.on("end",function(){var y=Buffer.alloc(d),g=0;y.fill(0);for(var L=0;L<o.length;L++){var c=o[L];c.copy(y,g),g+=c.length}a&&a(y)}),f.end(e)}}}});var Ue=F((pt,Re)=>{Re.exports=function(e){var n=H("zlib");return{inflate:function(){return n.inflateRawSync(e)},inflateAsync:function(s){var a=n.createInflateRaw(),f=[],o=0;a.on("data",function(d){f.push(d),o+=d.length}),a.on("end",function(){var d=Buffer.alloc(o),y=0;d.fill(0);for(var g=0;g<f.length;g++){var L=f[g];L.copy(d,y),y+=L.length}s&&s(d)}),a.end(e)}}}});var Me=F((St,Ze)=>{"use strict";var{randomFillSync:ve}=H("crypto"),$e=new Uint32Array(256).map((e,n)=>{for(let s=0;s<8;s++)n&1?n=n>>>1^3988292384:n>>>=1;return n>>>0}),He=(e,n)=>Math.imul(e,n)>>>0,Be=(e,n)=>$e[(e^n)&255]^e>>>8,b=()=>typeof ve=="function"?ve(Buffer.alloc(12)):b.node();b.node=()=>{let e=Buffer.alloc(12),n=e.length;for(let s=0;s<n;s++)e[s]=Math.random()*256&255;return e};var V={genSalt:b};function W(e){let n=Buffer.isBuffer(e)?e:Buffer.from(e);this.keys=new Uint32Array([305419896,591751049,878082192]);for(let s=0;s<n.length;s++)this.updateKeys(n[s])}W.prototype.updateKeys=function(e){let n=this.keys;return n[0]=Be(n[0],e),n[1]+=n[0]&255,n[1]=He(n[1],134775813)+1,n[2]=Be(n[2],n[1]>>>24),e};W.prototype.next=function(){let e=(this.keys[2]|2)>>>0;return He(e,e^1)>>8&255};function ke(e){let n=new W(e);return function(s){let a=Buffer.alloc(s.length),f=0;for(let o of s)a[f++]=n.updateKeys(o^n.next());return a}}function Qe(e){let n=new W(e);return function(s,a,f=0){a||(a=Buffer.alloc(s.length));for(let o of s){let d=n.next();a[f++]=o^d,n.updateKeys(o)}return a}}function et(e,n,s){if(!e||!Buffer.isBuffer(e)||e.length<12)return Buffer.alloc(0);let a=ke(s);if(a(e.slice(0,12))[11]!==n.crc>>>24)throw"ADM-ZIP: Wrong Password";return a(e.slice(12))}function tt(e){Buffer.isBuffer(e)&&e.length>=12?V.genSalt=function(){return e.slice(0,12)}:e==="node"?V.genSalt=b.node:V.genSalt=b}function rt(e,n,s,a=!1){e==null&&(e=Buffer.alloc(0)),Buffer.isBuffer(e)||(e=Buffer.from(e.toString()));let f=Qe(s),o=V.genSalt();o[11]=n.crc>>>24&255,a&&(o[10]=n.crc>>>16&255);let d=Buffer.alloc(e.length+12);return f(o,d),f(e,d,12)}Ze.exports={decrypt:et,encrypt:rt,_salter:tt}});var ze=F(X=>{X.Deflater=Fe();X.Inflater=Ue();X.ZipCrypto=Me()});var ne=F((Ot,Pe)=>{var S=z(),nt=te(),v=S.Constants,re=ze();Pe.exports=function(e){var n=new nt.EntryHeader,s=Buffer.alloc(0),a=Buffer.alloc(0),f=!1,o=null,d=Buffer.alloc(0);function y(){return!e||!Buffer.isBuffer(e)?Buffer.alloc(0):(n.loadDataHeaderFromBinary(e),e.slice(n.realDataOffset,n.realDataOffset+n.compressedSize))}function g(t){return!((n.flags&8)!==8&&S.crc32(t)!==n.dataHeader.crc)}function L(t,i,l){if(typeof i>"u"&&typeof t=="string"&&(l=t,t=void 0),f)return t&&i&&i(Buffer.alloc(0),S.Errors.DIRECTORY_CONTENT_ERROR),Buffer.alloc(0);var r=y();if(r.length===0)return t&&i&&i(r),r;if(n.encripted){if(typeof l!="string"&&!Buffer.isBuffer(l))throw new Error("ADM-ZIP: Incompatible password parameter");r=re.ZipCrypto.decrypt(r,n,l)}var I=Buffer.alloc(n.size);switch(n.method){case S.Constants.STORED:if(r.copy(I),g(I))return t&&i&&i(I),I;throw t&&i&&i(I,S.Errors.BAD_CRC),new Error(S.Errors.BAD_CRC);case S.Constants.DEFLATED:var D=new re.Inflater(r);if(t)D.inflateAsync(function(N){N.copy(N,0),i&&(g(N)?i(N):i(N,S.Errors.BAD_CRC))});else{if(D.inflate(I).copy(I,0),!g(I))throw new Error(S.Errors.BAD_CRC+" "+s.toString());return I}break;default:throw t&&i&&i(Buffer.alloc(0),S.Errors.UNKNOWN_METHOD),new Error(S.Errors.UNKNOWN_METHOD)}}function c(t,i){if((!o||!o.length)&&Buffer.isBuffer(e))return t&&i&&i(y()),y();if(o.length&&!f){var l;switch(n.method){case S.Constants.STORED:return n.compressedSize=n.size,l=Buffer.alloc(o.length),o.copy(l),t&&i&&i(l),l;default:case S.Constants.DEFLATED:var r=new re.Deflater(o);if(t)r.deflateAsync(function(D){l=Buffer.alloc(D.length),n.compressedSize=D.length,D.copy(l),i&&i(l)});else{var I=r.deflate();return n.compressedSize=I.length,I}r=null;break}}else if(t&&i)i(Buffer.alloc(0));else return Buffer.alloc(0)}function E(t,i){return(t.readUInt32LE(i+4)<<4)+t.readUInt32LE(i)}function m(t){for(var i=0,l,r,I;i<t.length;)l=t.readUInt16LE(i),i+=2,r=t.readUInt16LE(i),i+=2,I=t.slice(i,i+r),i+=r,v.ID_ZIP64===l&&u(I)}function u(t){var i,l,r,I;t.length>=v.EF_ZIP64_SCOMP&&(i=E(t,v.EF_ZIP64_SUNCOMP),n.size===v.EF_ZIP64_OR_32&&(n.size=i)),t.length>=v.EF_ZIP64_RHO&&(l=E(t,v.EF_ZIP64_SCOMP),n.compressedSize===v.EF_ZIP64_OR_32&&(n.compressedSize=l)),t.length>=v.EF_ZIP64_DSN&&(r=E(t,v.EF_ZIP64_RHO),n.offset===v.EF_ZIP64_OR_32&&(n.offset=r)),t.length>=v.EF_ZIP64_DSN+4&&(I=t.readUInt32LE(v.EF_ZIP64_DSN),n.diskNumStart===v.EF_ZIP64_OR_16&&(n.diskNumStart=I))}return{get entryName(){return s.toString()},get rawEntryName(){return s},set entryName(t){s=S.toBuffer(t);var i=s[s.length-1];f=i===47||i===92,n.fileNameLength=s.length},get extra(){return d},set extra(t){d=t,n.extraLength=t.length,m(t)},get comment(){return a.toString()},set comment(t){a=S.toBuffer(t),n.commentLength=a.length},get name(){var t=s.toString();return f?t.substr(t.length-1).split("/").pop():t.split("/").pop()},get isDirectory(){return f},getCompressedData:function(){return c(!1,null)},getCompressedDataAsync:function(t){c(!0,t)},setData:function(t){o=S.toBuffer(t),!f&&o.length?(n.size=o.length,n.method=S.Constants.DEFLATED,n.crc=S.crc32(t),n.changed=!0):n.method=S.Constants.STORED},getData:function(t){return n.changed?o:L(!1,null,t)},getDataAsync:function(t,i){n.changed?t(o):L(!0,t,i)},set attr(t){n.attr=t},get attr(){return n.attr},set header(t){n.loadFromBinary(t)},get header(){return n},packHeader:function(){var t=n.entryHeaderToBinary(),i=S.Constants.CENHDR;return s.copy(t,i),i+=s.length,n.extraLength&&(d.copy(t,i),i+=n.extraLength),n.commentLength&&a.copy(t,i),t},toJSON:function(){let t=function(i){return"<"+(i&&i.length+" bytes buffer"||"null")+">"};return{entryName:this.entryName,name:this.name,comment:this.comment,isDirectory:this.isDirectory,header:n.toJSON(),compressedData:t(e),data:t(o)}},toString:function(){return JSON.stringify(this.toJSON(),null,"	")}}}});var be=F((wt,Ge)=>{var je=ne(),ot=te(),R=z();Ge.exports=function(e,n){var s=[],a={},f=Buffer.alloc(0),o=new ot.MainHeader,d=!1;let y=Object.assign(Object.create(null),n),{noSort:g}=y;e?E(y.readEntries):d=!0;function L(u){let t=o.diskEntries,i=o.offset;for(let l=0;l<t;l++){let r=i,I=new je(e);I.header=e.slice(r,r+=R.Constants.CENHDR),I.entryName=e.slice(r,r+=I.header.fileNameLength),i+=I.header.entryHeaderSize,u(I)}}function c(){d=!0,a={},s=new Array(o.diskEntries);for(var u=o.offset,t=0;t<s.length;t++){var i=u,l=new je(e);l.header=e.slice(i,i+=R.Constants.CENHDR),l.entryName=e.slice(i,i+=l.header.fileNameLength),l.header.extraLength&&(l.extra=e.slice(i,i+=l.header.extraLength)),l.header.commentLength&&(l.comment=e.slice(i,i+l.header.commentLength)),u+=l.header.entryHeaderSize,s[t]=l,a[l.entryName]=l}}function E(u){var t=e.length-R.Constants.ENDHDR,i=Math.max(0,t-65535),l=i,r=e.length,I=-1,D=0;for(t;t>=l;t--)if(e[t]===80){if(e.readUInt32LE(t)===R.Constants.ENDSIG){I=t,D=t,r=t+R.Constants.ENDHDR,l=t-R.Constants.END64HDR;continue}if(e.readUInt32LE(t)===R.Constants.END64SIG){l=i;continue}if(e.readUInt32LE(t)===R.Constants.ZIP64SIG){I=t,r=t+R.readBigUInt64LE(e,t+R.Constants.ZIP64SIZE)+R.Constants.ZIP64LEAD;break}}if(!~I)throw new Error(R.Errors.INVALID_FORMAT);o.loadFromBinary(e.slice(I,r)),o.commentLength&&(f=e.slice(D+R.Constants.ENDHDR)),u&&c()}function m(){s.length>1&&!g&&s.sort((u,t)=>u.entryName.toLowerCase().localeCompare(t.entryName.toLowerCase()))}return{get entries(){return d||c(),s},get comment(){return f.toString()},set comment(u){f=R.toBuffer(u),o.commentLength=f.length},getEntryCount:function(){return d?s.length:o.diskEntries},forEach:function(u){if(!d){L(u);return}s.forEach(u)},getEntry:function(u){return d||c(),a[u]||null},setEntry:function(u){d||c(),s.push(u),a[u.entryName]=u,o.totalEntries=s.length},deleteEntry:function(u){d||c();var t=a[u];if(t&&t.isDirectory){var i=this;this.getEntryChildren(t).forEach(function(l){l.entryName!==u&&i.deleteEntry(l.entryName)})}s.splice(s.indexOf(t),1),delete a[u],o.totalEntries=s.length},getEntryChildren:function(u){if(d||c(),u&&u.isDirectory){let t=[],i=u.entryName,l=i.length;return s.forEach(function(r){r.entryName.substr(0,l)===i&&t.push(r)}),t}return[]},compressToBuffer:function(){d||c(),m();let u=[],t=[],i=0,l=0;o.size=0,o.offset=0;for(let D of s){let N=D.getCompressedData();D.header.offset=l;let O=D.header.dataHeaderToBinary(),_=D.rawEntryName.length,C=Buffer.alloc(_+D.extra.length);D.rawEntryName.copy(C,0),C.copy(D.extra,_);let T=O.length+C.length+N.length;l+=T,u.push(O),u.push(C),u.push(N);let A=D.packHeader();t.push(A),o.size+=A.length,i+=T+A.length}i+=o.mainHeaderSize,o.offset=l,l=0;let r=Buffer.alloc(i);for(let D of u)D.copy(r,l),l+=D.length;for(let D of t)D.copy(r,l),l+=D.length;let I=o.toBinary();return f&&f.copy(I,R.Constants.ENDHDR),I.copy(r,l),r},toAsyncBuffer:function(u,t,i,l){try{d||c(),m();let r=[],I=[],D=0,N=0;o.size=0,o.offset=0;let O=function(_){if(_.length){let C=_.pop(),T=C.entryName+C.extra.toString();i&&i(T),C.getCompressedDataAsync(function(A){l&&l(T),C.header.offset=N;let M=C.header.dataHeaderToBinary(),ie=Buffer.alloc(T.length,T),se=M.length+ie.length+A.length;N+=se,r.push(M),r.push(ie),r.push(A);let J=C.packHeader();I.push(J),o.size+=J.length,D+=se+J.length,O(_)})}else{D+=o.mainHeaderSize,o.offset=N,N=0;let C=Buffer.alloc(D);r.forEach(function(A){A.copy(C,N),N+=A.length}),I.forEach(function(A){A.copy(C,N),N+=A.length});let T=o.toBinary();f&&f.copy(T,R.Constants.ENDHDR),T.copy(C,N),u(C)}};O(s)}catch(r){t(r)}}}}});var Ve=F((Tt,qe)=>{var w=z(),B=H("path"),it=ne(),st=be(),Z=(e,n)=>typeof e=="boolean"?e:n,oe=(e,n)=>typeof e=="string"?e:n,ft={noSort:!1,readEntries:!1,method:w.Constants.NONE,fs:null};qe.exports=function(e,n){let s=null,a=Object.assign(Object.create(null),ft);e&&typeof e=="object"&&(e instanceof Uint8Array||(Object.assign(a,e),e=a.input?a.input:void 0,a.input&&delete a.input),Buffer.isBuffer(e)&&(s=e,a.method=w.Constants.BUFFER,e=void 0)),Object.assign(a,n);let f=new w(a);if(e&&typeof e=="string")if(f.fs.existsSync(e))a.method=w.Constants.FILE,a.filename=e,s=f.fs.readFileSync(e);else throw new Error(w.Errors.INVALID_FILENAME);let o=new st(s,a),{canonical:d,sanitize:y}=w;function g(c){if(c&&o){var E;if(typeof c=="string"&&(E=o.getEntry(c)),typeof c=="object"&&typeof c.entryName<"u"&&typeof c.header<"u"&&(E=o.getEntry(c.entryName)),E)return E}return null}function L(c){let{join:E,normalize:m,sep:u}=B.posix;return E(".",m(u+c.split("\\").join(u)+u))}return{readFile:function(c,E){var m=g(c);return m&&m.getData(E)||null},readFileAsync:function(c,E){var m=g(c);m?m.getDataAsync(E):E(null,"getEntry failed for:"+c)},readAsText:function(c,E){var m=g(c);if(m){var u=m.getData();if(u&&u.length)return u.toString(E||"utf8")}return""},readAsTextAsync:function(c,E,m){var u=g(c);u?u.getDataAsync(function(t,i){if(i){E(t,i);return}t&&t.length?E(t.toString(m||"utf8")):E("")}):E("")},deleteFile:function(c){var E=g(c);E&&o.deleteEntry(E.entryName)},addZipComment:function(c){o.comment=c},getZipComment:function(){return o.comment||""},addZipEntryComment:function(c,E){var m=g(c);m&&(m.comment=E)},getZipEntryComment:function(c){var E=g(c);return E&&E.comment||""},updateFile:function(c,E){var m=g(c);m&&m.setData(E)},addLocalFile:function(c,E,m,u){if(f.fs.existsSync(c)){E=E?L(E):"";var t=c.split("\\").join("/").split("/").pop();E+=m||t;let i=f.fs.statSync(c);this.addFile(E,f.fs.readFileSync(c),u,i)}else throw new Error(w.Errors.FILE_NOT_FOUND.replace("%s",c))},addLocalFolder:function(c,E,m,u){if(m instanceof RegExp?m=function(t){return function(i){return t.test(i)}}(m):typeof m!="function"&&(m=function(){return!0}),E=E?L(E):"",c=B.normalize(c),f.fs.existsSync(c)){let t=f.findFiles(c),i=this;t.length&&t.forEach(function(l){var r=B.relative(c,l).split("\\").join("/");if(m(r)){var I=f.fs.statSync(l);I.isFile()?i.addFile(E+r,f.fs.readFileSync(l),"",u||I):i.addFile(E+r+"/",Buffer.alloc(0),"",u||I)}})}else throw new Error(w.Errors.FILE_NOT_FOUND.replace("%s",c))},addLocalFolderAsync:function(c,E,m,u){u instanceof RegExp?u=function(i){return function(l){return i.test(l)}}(u):typeof u!="function"&&(u=function(){return!0}),m=m?L(m):"",c=B.normalize(c);var t=this;f.fs.open(c,"r",function(i){if(i&&i.code==="ENOENT")E(void 0,w.Errors.FILE_NOT_FOUND.replace("%s",c));else if(i)E(void 0,i);else{var l=f.findFiles(c),r=-1,I=function(){if(r+=1,r<l.length){var D=l[r],N=B.relative(c,D).split("\\").join("/");N=N.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\x20-\x7E]/g,""),u(N)?f.fs.stat(D,function(O,_){O&&E(void 0,O),_.isFile()?f.fs.readFile(D,function(C,T){C?E(void 0,C):(t.addFile(m+N,T,"",_),I())}):(t.addFile(m+N+"/",Buffer.alloc(0),"",_),I())}):process.nextTick(()=>{I()})}else E(!0,void 0)};I()}})},addLocalFolderPromise:function(c,E){return new Promise((m,u)=>{let{filter:t,zipPath:i}=Object.assign({},E);this.addLocalFolderAsync(c,(l,r)=>{r&&u(r),l&&m(this)},i,t)})},addFile:function(c,E,m,u){let t=g(c),i=t!=null;i||(t=new it,t.entryName=c),t.comment=m||"";let l=typeof u=="object"&&u instanceof f.fs.Stats;l&&(t.header.time=u.mtime);var r=t.isDirectory?16:0;let I=t.isDirectory?16384:32768;l?I|=4095&u.mode:typeof u=="number"?I|=4095&u:I|=t.isDirectory?493:420,r=(r|I<<16)>>>0,t.attr=r,t.setData(E),i||o.setEntry(t)},getEntries:function(){return o?o.entries:[]},getEntry:function(c){return g(c)},getEntryCount:function(){return o.getEntryCount()},forEach:function(c){return o.forEach(c)},extractEntryTo:function(c,E,m,u,t,i){u=Z(u,!1),t=Z(t,!1),m=Z(m,!0),i=oe(i,oe(t,void 0));var l=g(c);if(!l)throw new Error(w.Errors.NO_ENTRY);var r=d(l.entryName),I=y(E,i&&!l.isDirectory?i:m?r:B.basename(r));if(l.isDirectory){var D=o.getEntryChildren(l);return D.forEach(function(_){if(_.isDirectory)return;var C=_.getData();if(!C)throw new Error(w.Errors.CANT_EXTRACT_FILE);var T=d(_.entryName),A=y(E,m?T:B.basename(T));let M=t?_.header.fileAttr:void 0;f.writeFileTo(A,C,u,M)}),!0}var N=l.getData();if(!N)throw new Error(w.Errors.CANT_EXTRACT_FILE);if(f.fs.existsSync(I)&&!u)throw new Error(w.Errors.CANT_OVERRIDE);let O=t?c.header.fileAttr:void 0;return f.writeFileTo(I,N,u,O),!0},test:function(c){if(!o)return!1;for(var E in o.entries)try{if(E.isDirectory)continue;var m=o.entries[E].getData(c);if(!m)return!1}catch{return!1}return!0},extractAllTo:function(c,E,m,u){if(E=Z(E,!1),u=oe(m,u),m=Z(m,!1),!o)throw new Error(w.Errors.NO_ZIP);o.entries.forEach(function(t){var i=y(c,d(t.entryName.toString()));if(t.isDirectory){f.makeDir(i);return}var l=t.getData(u);if(!l)throw new Error(w.Errors.CANT_EXTRACT_FILE);let r=m?t.header.fileAttr:void 0;f.writeFileTo(i,l,E,r);try{f.fs.utimesSync(i,t.header.time,t.header.time)}catch{throw new Error(w.Errors.CANT_EXTRACT_FILE)}})},extractAllToAsync:function(c,E,m,u){if(E=Z(E,!1),typeof m=="function"&&!u&&(u=m),m=Z(m,!1),u||(u=function(D){throw new Error(D)}),!o){u(new Error(w.Errors.NO_ZIP));return}c=B.resolve(c);let t=D=>y(c,B.normalize(d(D.entryName.toString()))),i=(D,N)=>new Error(D+': "'+N+'"'),l=[],r=new Set;o.entries.forEach(D=>{D.isDirectory?l.push(D):r.add(D)});for(let D of l){let N=t(D),O=m?D.header.fileAttr:void 0;try{f.makeDir(N),O&&f.fs.chmodSync(N,O),f.fs.utimesSync(N,D.header.time,D.header.time)}catch{u(i("Unable to create folder",N))}}let I=()=>{r.size===0&&u()};for(let D of r.values()){let N=B.normalize(d(D.entryName.toString())),O=y(c,N);D.getDataAsync(function(_,C){if(C){u(new Error(C));return}if(!_)u(new Error(w.Errors.CANT_EXTRACT_FILE));else{let T=m?D.header.fileAttr:void 0;f.writeFileToAsync(O,_,E,T,function(A){if(!A){u(i("Unable to write file",O));return}f.fs.utimes(O,D.header.time,D.header.time,function(M){if(M){u(i("Unable to set times",O));return}r.delete(D),I()})})}})}I()},writeZip:function(c,E){if(arguments.length===1&&typeof c=="function"&&(E=c,c=""),!c&&a.filename&&(c=a.filename),!!c){var m=o.compressToBuffer();if(m){var u=f.writeFileTo(c,m,!0);typeof E=="function"&&E(u?null:new Error("failed"),"")}}},writeZipPromise:function(c,E){let{overwrite:m,perm:u}=Object.assign({overwrite:!0},E);return new Promise((t,i)=>{!c&&a.filename&&(c=a.filename),c||i("ADM-ZIP: ZIP File Name Missing"),this.toBufferPromise().then(l=>{let r=I=>I?t(I):i("ADM-ZIP: Wasn't able to write zip file");f.writeFileToAsync(c,l,m,u,r)},i)})},toBufferPromise:function(){return new Promise((c,E)=>{o.toAsyncBuffer(c,E)})},toBuffer:function(c,E,m,u){return this.valueOf=2,typeof c=="function"?(o.toAsyncBuffer(c,E,m,u),null):o.compressToBuffer()}}}});import K from"path";import ct from"fs/promises";import ut from"os";import{spawn as at}from"child_process";var We=Xe(Ve(),1);import lt from"url";var jt=fe.memo(async()=>{let e=await me(),n=await de(),s=Ee(),a=new Map,f=new Map,o=process.platform==="win32"?"handler.exe":"handler";s.register({shouldBuild:d=>{if(!d.file.endsWith(".java"))return!1;let y=f.get(d.functionID);return y?ue(y,d.file):!1},canHandle:d=>d.startsWith("java"),startWorker:async d=>{let y=at("java",["-cp",[lt.fileURLToPath(new URL("../../support/java-runtime/release/*",import.meta.url))].join(ut.platform()==="win32"?";":":"),"com.amazonaws.services.lambda.runtime.api.client.AWSLambda",d.handler],{env:{...process.env,...d.environment,IS_LOCAL:"true",AWS_LAMBDA_RUNTIME_API:`localhost:${n.port}/${d.workerID}`},cwd:d.out});y.on("exit",()=>e.exited(d.workerID)),y.stdout.on("data",g=>{e.stdout(d.workerID,g.toString())}),y.stderr.on("data",g=>{e.stdout(d.workerID,g.toString())}),a.set(d.workerID,y)},stopWorker:async d=>{let y=a.get(d);y&&(y.kill(),a.delete(d))},build:async d=>{var m,u;let y=le(),g=await ce(y.paths.root,"build.gradle"),L=await Et(g),c=((m=d.props.java)==null?void 0:m.buildTask)||"build",E=((u=d.props.java)==null?void 0:u.buildOutputDir)||"distributions";f.set(d.functionID,g);try{await Ie(`${L} ${c} -Dorg.gradle.logging.level=${process.env.DEBUG?"debug":"lifecycle"}`,{cwd:g});let t=K.join(g,"build",E),i=(await ct.readdir(t)).find(l=>l.endsWith(".zip"));return new We.default(K.join(t,i)).extractAllTo(d.out),{type:"success",handler:d.props.handler}}catch(t){return{type:"error",errors:[t.stderr]}}}})});async function Et(e){let n=K.resolve(K.join(e,"gradlew"));return await ae(n)?n:"gradle"}export{jt as useJavaHandler};
